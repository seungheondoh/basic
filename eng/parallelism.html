

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Training Parallelism Overview (Data, Model, Tensor) &#8212; Music Information Retrieval &amp; Machine Learning Blog</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'eng/parallelism';</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Feed forward Network (순방향 신경망)" href="../ml/deeplearning.html" />
    <link rel="prev" title="Audio Matching with Dynamic Programming (다이나믹 프로그래밍을 이용한 오디오 매칭)" href="../music_audio/dynamic_programming.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Music Information Retrieval & Machine Learning Blog - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Music Information Retrieval & Machine Learning Blog - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Music, Audio and Machine Learning Blog
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Music and Audio Processing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../music_audio/basic_dsp.html">Basic Digital Signal Processing (디지털 신호처리 기초)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../music_audio/ear.html">Auditory Pathway (귀의 청각경로)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../music_audio/dynamic_programming.html">Audio Matching with Dynamic Programming (다이나믹 프로그래밍을 이용한 오디오 매칭)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Engineering</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Training Parallelism Overview (Data, Model, Tensor)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ml/deeplearning.html">Feed forward Network (순방향 신경망)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ml/optim.html">Optimization (최적화)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Ph.D Survival</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../phd/advice.html">About Advising (연구 지도에 관하여)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../phd/pessimism.html">Reflecting on ‘There is no contribution to this paper.’ (냉소적 논문읽기에 대한 반성)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/seungheondoh/basic" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/seungheondoh/basic/issues/new?title=Issue%20on%20page%20%2Feng/parallelism.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/eng/parallelism.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Training Parallelism Overview (Data, Model, Tensor)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-parallelism-dp-ddp">Data Parallelism(DP, DDP)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-parallelism-pipeline-parallelism-mp-pp">Model Parallelism / Pipeline Parallelism (MP / PP)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-parallelism-tp">Tensor Parallelism (TP)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="training-parallelism-overview-data-model-tensor">
<h1>Training Parallelism Overview (Data, Model, Tensor)<a class="headerlink" href="#training-parallelism-overview-data-model-tensor" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>이 글은 <a class="reference external" href="https://sumanthrh.com/post/distributed-and-efficient-finetuning/">Everything about Distributed Training and Efficient Finetuning-Sumanthrh</a>, <a class="reference external" href="https://lilianweng.github.io/posts/2021-09-25-train-large/">How to Train Really Large Models on Many GPUs?-lilianweng</a> <a class="reference external" href="https://github.com/tunib-ai/large-scale-lm-tutorials">TUNiB-large-scale-lm-tutorials</a>을 참고했습니다.</p></li>
</ul>
<p>요즘 Large-Scale Training은 모델의 성능과 새로운 <a class="reference external" href="https://arxiv.org/abs/2206.07682">Emerging ability</a>를 보여주기 떄문에 많은 사람들의 관심을 받고 있습니다. 이러한 Large-Scale 학습의 목적은 큰 모델 크기 (Billion Scale)과 대규모 데이터셋 (Million Scale) 입니다. 우리의 목표는 가능한 많은 샘플을 초당 처리할수 있도록 하는 것입니다. 이러한 문제로 인해 우리는 큰 GPU vRAM이 필요합니다. 모델 가중치와 데이터를 올려야합니다.</p>
<p>이렇듯 큰 모델과 큰 데이터를 처리하려면 여러대의 GPU를 사용하여 병렬 처리 (Parallelism)가 중요합니다. 병렬처리는 여러개를 동시에 처리하는 기술을 뜻하며, 이떄 중요한 것은 데이터 처리량 (throughput), 메모리의 효율성 등입니다. 병렬 처리 (Parallelism)는 모델의 측면 (MP,PP), 데이터의 측면 (DP), 그리고 텐서의 측면 (TP)에서 진행할 수 있습니다.</p>
<section id="data-parallelism-dp-ddp">
<h2>Data Parallelism(DP, DDP)<a class="headerlink" href="#data-parallelism-dp-ddp" title="Permalink to this heading">#</a></h2>
<p>Data Parallelism은 엄격하게 DP와 DDP로 나누어집니다. DP는 0번째 GPU에서 모델의 업데이트가 이루어지고, 모델은 각 GPU로 복제됩니다. forward 과정에서 각 GPU의 output들은 loss연산을 위해서 GPU 0번으로 보내지고, 연산된 loss는 다시 각 GPU로 분산됩니다. 또한 각 GPU의 gradient또한 GPU 0번으로 보내져서 평균화 됩니다. 이 과정에서 GPU 0은 큰 메모리 소모가 발생하게 됩니다.</p>
<ol class="arabic simple">
<li><p>Data Scatter: Bactch를 Scatter하여 각 GPU로 전송</p></li>
<li><p>Model Broadcast: GPU 0번째 모델을 다른 GPU로 Broadcase</p></li>
<li><p><strong>Forward</strong>: 각 Broadcase된 모델들은 Scatter된 데이터를 처리하여 Output 연산</p></li>
<li><p>Output Gather: Output을 다시 GPU 0번에 모음 &amp; Loss연산</p></li>
<li><p>Loss Scatter: 계산된 Loss를 각 GPU에 Scatter</p></li>
<li><p><strong>Backward</strong>: 각 GPU는 Gradients 연산 (<code class="docutils literal notranslate"><span class="pre">loss.backward()</span></code>)</p></li>
<li><p>Gradient Reduce: 계산된 Gradient를 GPU 0번에서 Reduce하여 더함</p></li>
<li><p>Update: 더해진 Graident들을 사용해서 GPU 0번째 모델을 업데이트 <code class="docutils literal notranslate"><span class="pre">optimizer.step()</span></code></p></li>
</ol>
<p><strong>backward()가 step()보다 무거운 연산임을 알아두면 좋습니다.</strong></p>
<p>이와 달리 DDP는 각 GPU에 모델을 복제하고 각각의 로컬 그라디언트를 모든 프로세스에서 평균화하는 방식을 사용합니다. 이는 그라디언트를 효율적으로 통합하여 학습을 진행합니다. 또 다른 차이점은 DDP는 torch.distributed를 사용하여 데이터를 복사하고, DP는 Python 스레드를 통해 프로세스 내에서 데이터를 복사합니다(이로 인해 GIL과 관련된 제한이 발생합니다). 결과적으로 Distributed Data Parallel (DDP)이 일반적으로 Data Parallel (DP)보다 빠르며, 느린 GPU 간 연결이 없는 경우에 해당합니다.</p>
<p>물론 DDP가 효율적이며, 일반적으로 Data Parallelism을 뜻하게 됩니다.</p>
<p>각 GPU 워커는 전체 미니 배치의 일부를 받아들이고, 해당 미니 배치 데이터에서 Gradients를 계산합니다. 그런 다음 Gradients는 모든 워커를 통해 평균화되고 모델 가중치가 업데이트됩니다. PyTorch DDP와 같은 가장 기본적인 형태에서 각 GPU는 작업 중인 데이터 부분에 대한 weight, optimizer, gradients의 status 저장합니다.</p>
</section>
<section id="model-parallelism-pipeline-parallelism-mp-pp">
<h2>Model Parallelism / Pipeline Parallelism (MP / PP)<a class="headerlink" href="#model-parallelism-pipeline-parallelism-mp-pp" title="Permalink to this heading">#</a></h2>
<p>모델이 너무 커서 하나의 디바이스에 올라갈수 없다면, 여러 GPU에 나눠서 올려야합니다. 모델 병렬화에서는 모델이 수직 혹은 수평으로 나뉘어 모델의 다른 레이어가 다른 GPU 워커에 배치됩니다. 단일 모델에 12개의 레이어가 있는 경우 3개의 GPU에 배치된 경우를 생각해보세요.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>---------------<span class="w">  </span>---------------<span class="w">  </span>-----------------
<span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="p">|</span>
---------------<span class="w">  </span>---------------<span class="w">  </span>-----------------
</pre></div>
</div>
<p>단순 모델 병렬화에서는 모든 GPU가 동일한 데이터 배치를 처리하는 동안 이전 GPU가 계산을 마칠 때까지 기다린 다음 데이터를 처리합니다. 이를 개선한 것이 바로 Pipeline Parallelism (PP) 입니다. 여기서는 Micro Batch를 구현하여, 마이크로 배치 데이터에 대해 계산을 겹쳐서 병렬처리를 구현합니다.</p>
</section>
<section id="tensor-parallelism-tp">
<h2>Tensor Parallelism (TP)<a class="headerlink" href="#tensor-parallelism-tp" title="Permalink to this heading">#</a></h2>
<p>텐서 병렬화에서 각 GPU는 모델을 수평으로 나누어 텐서의 일부만 처리합니다. 각 워커는 동일한 데이터 배치를 처리하며 자신이 가진 가중치 부분에 대한 활성화를 계산하고 서로 필요한 부분을 교환하며 각 워커는 가중치 일부에 대한 기울기를 계산합니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>

<span class="c1">### standard mlp</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
<span class="n">w1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">64</span><span class="p">)</span>
<span class="n">w2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
<span class="n">act_fn</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">act_fn</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">w1</span><span class="p">)</span> <span class="o">@</span> <span class="n">w2</span>

<span class="c1">### column parallel</span>
<span class="n">w11</span><span class="p">,</span> <span class="n">w12</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">split_size_or_sections</span><span class="o">=</span><span class="p">[</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># row parallel</span>
<span class="n">w21</span><span class="p">,</span> <span class="n">w22</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="n">split_size_or_sections</span><span class="o">=</span><span class="p">[</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">act_fn</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">w11</span><span class="p">)</span> <span class="o">@</span> <span class="n">w21</span> <span class="o">+</span> <span class="n">act_fn</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">w12</span><span class="p">)</span> <span class="o">@</span> <span class="n">w22</span>
<span class="n">torch</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./eng"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../music_audio/dynamic_programming.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Audio Matching with Dynamic Programming (다이나믹 프로그래밍을 이용한 오디오 매칭)</p>
      </div>
    </a>
    <a class="right-next"
       href="../ml/deeplearning.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Feed forward Network (순방향 신경망)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-parallelism-dp-ddp">Data Parallelism(DP, DDP)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-parallelism-pipeline-parallelism-mp-pp">Model Parallelism / Pipeline Parallelism (MP / PP)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-parallelism-tp">Tensor Parallelism (TP)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By SeungHeon Doh
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>