# Invariance and Equivariance

변하지 않는 성질과(invariance) 과 같이 변하는 성질(equivaraince)은 내가 연구하는 deep learning에서 매우 중요한 개념이다. invariance는 어떤 변형 (Transform, i.e. 회전, 이동, 크기조절)이 데이터에 적용되더라도 데이터의 출력이 변하지 않는 특성을 만한다. 예를들어, 얼굴 인식 모델에서는 얼굴 이미지를 회전시키거나 크기를 조절하더라도 모델은 그것을 얼굴로 인식합니다. 또한 노래방에서 여자 키인 음악을 남자 키로 바꾸더라도 우리는 같은 음악으로 인식할 수 있습니다. 반면 equivariance는 데이터의 변형이 생기면 모델의 출력도 그 변형에 따라 동일한 방식으로 변경되는 특징을 뜻합니다. 예를들어서, 이미지에서 물체를 Segment하는 모델이 있다고 해봅시다. 이미지의 물체가 오른쪽으로 이동하면, Segment Box의 위치 값은 오른쪽으로 움직여야합니다.

이를 수식으로 표현한다면, 어떤 함수 $f$에 대해서 변환 $T$에 대해서, 다음과 같은 성질을 가질때, $f$는 $T$에 대해서 invariance하다고 표현할 수 있습니다.

$$
f(x) = f(T(x)) \\
f(\alpha \dot x) = f(x)
$$

여기서 $x$는 입력 데이터이며, T는 특정 변환입니다.

반면 equivariance는 함수 $f$가, 변환 $T$에 대해서 다음과 같은 성질을 가질때 성립합니다.

$$
f(T(x)) = T(f(x)) \\
f(\alpha \dot x) = \alpha \dot f(x)
$$

이러한 변하지 않는 성질과 같이 변하는 성질은 우리가 어떤 이미지나 음악이 비슷하다라고 느끼는 데 큰 영향을 주게 됩니다. 예를 들어서, 하나의 이미지(x)가 같은 이미지가 90도로 회전 이동을 한 $x_i = T(x, 90)$, 180도로 회전 이동을 한 $x_j = T(x, 180)$ 가 있다고 할때 우리는 두 이미지가 유사하다는 것을 알수 있습니다. 왜냐하면 질감이나 색상은 동일하니까요. 하지만 크기를 확대해 볼까요? 이제 변환 함수 T는 Zoom in 기능입니다. Zoom in 기능을 통해서 크기를 확대할 때, 1.2배 확대한 이미지와 $x_i = T(x, 1.2)$, 1000배 확대한 픽셀 한 두개 밖에 안보인 이미지에 대해서 $x_j = T(x, 1000)$ 우리는 유사하다고 느끼지 않습니다. 이는 크기에 대한 이미지의 invarience가 깨지기 때문이죠. 우리는 모든 변환에 대해서 이미지의 invarience를 보장하지 않습니다. 반면에 또 다른 이미지 $y$ 에 대해서 또 1000배만큼 확장해 볼까요? $y_j = T(x, 1000)$ 를 하면 한 두개의 픽셀의 이미지만 보이게 될겁니다. 이렇게 된다면 우리는 $x_i = T(x, 1.2)$, $x_j = T(x, 1000)$, $y_j = T(x, 1000)$ 를 비교할때, 1000배로 확대된 x_j와 y_j가 비슷하다고 느낄수 있게됩니다. 둘은 같이 변했거든요! 만약 zoom in이 중요한 카메라를 평가하는 모델이라면, 변환에 대한 equivariance가 중요해질겁니다. 반면에 얼굴을 인식하는 모델이라면 이미지에 대한 invariance가 중요해지죠. 

이제 컨텐츠를 만드는 사람의 입장으로 생각해봅시다. 과연 변화가 중요할까요 물체가 중요할까요?